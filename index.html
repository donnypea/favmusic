<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
<link rel="icon" type="image/png" href="images/music.png" />
<title>FavMusic ‚Äî Modern Player</title>
<style>
  /* Light mode variables */
body.light{
  --bg:#f5f7fb;
  --card:#ffffff;
  --muted:#5b6472;
  --accent:#7c3aed;
  --glass: rgba(0,0,0,0.05);
  background: linear-gradient(180deg,#e9ecf3 0%, #f5f7fb 60%);
  color:#0f1724;
}

/* Animated gradient background for the whole body */
body.animated-bg {
  background: linear-gradient(270deg, #7c3aed, #2b6ce4, #e91e63, #ff9800);
  background-size: 800% 800%;
  animation: gradientBG 20s ease infinite;
}

@keyframes gradientBG {
  0% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
  100% { background-position: 0% 50%; }
}


/* Floating toggle button */
.theme-toggle{
  position:fixed;
  bottom:20px;
  right:20px;
  width:50px;
  height:50px;
  border-radius:50%;
  background:var(--card);
  display:flex;
  align-items:center;
  justify-content:center;
  cursor:pointer;
  box-shadow:0 8px 20px rgba(0,0,0,0.3);
  z-index:999;
  transition:0.3s;
}

.theme-toggle i{
  font-size:20px;
  color:var(--accent);
}

.theme-toggle:hover{
  transform:scale(1.1);
}

:root{
  --bg:#0f1724; --card:#0b1220; --muted:#9aa4b2; --accent:#7c3aed; --glass: rgba(255,255,255,0.03);
}
*{box-sizing:border-box}
body{
  margin:0; font-family:system-ui,Segoe UI,Roboto,Arial; min-height:100vh;
  background: linear-gradient(180deg,#071025 0%, #081426 60%);
  color:#e6eef8;
}
header{
  width:100%; padding:12px 24px; display:flex; align-items:center; justify-content:space-between;
  background: var(--card); position:sticky; top:0; z-index:100; box-shadow: 0 5px 15px rgba(0,0,0,0.5);
}
header h1{margin:0; font-size:20px; cursor:pointer; color:var(--accent);}
header nav a{margin-left:18px; color:#e6eef8; text-decoration:none; font-weight:500;}
header nav a:hover{color:var(--accent);}
.container{display:flex; justify-content:center; padding:24px;}
.player{
  width:100%; max-width:980px; background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  border-radius:18px; padding:18px; box-shadow: 0 10px 30px rgba(2,6,23,0.7);
  display:grid; grid-template-columns:320px 1fr; gap:18px;
}
.left{
  display:flex; flex-direction:column; gap:14px; align-items:center;
}
.cover{
  width:100%; aspect-ratio:1/1; background:linear-gradient(135deg,var(--accent), #2b6ce4);
  border-radius:12px; display:flex; align-items:center; justify-content:center; background-size:cover;
}
.title{font-weight:700; font-size:18px; text-align:center;}
.artist{font-size:13px; color:var(--muted); text-align:center;}
.progress{height:10px; background:rgba(255,255,255,0.05); border-radius:999px; cursor:pointer; width:100%;}
.progress .bar{height:100%; width:0%; border-radius:999px; background:linear-gradient(90deg,var(--accent), #2b6ce4);}
.time{display:flex; justify-content:space-between; font-size:12px; color:var(--muted); width:100%;}
.controls{display:flex; justify-content:center; gap:10px; flex-wrap:wrap;}
button{background:var(--glass); border:0; color:white; padding:10px 14px; border-radius:10px; cursor:pointer; transition:0.2s;}
button:hover{background:rgba(124,58,237,0.25);}
input[type=range]{cursor:pointer;}
.right{display:flex; flex-direction:column;}
.playlist{margin-top:10px; overflow:auto; max-height:420px;}
.track{padding:10px; border-radius:10px; cursor:pointer; display:flex; align-items:center; gap:10px;}
.track img{width:40px; height:40px; object-fit:cover; border-radius:6px;}
.track:hover{background:rgba(255,255,255,0.05);}
.track.playing{background:rgba(124,58,237,0.25);}
.pagination{display:flex; justify-content:center; gap:6px; margin-top:8px; flex-wrap:wrap;}
.pagination button{padding:4px 8px; font-size:12px;}
footer{margin-top:24px;text-align:center;color:var(--muted); font-size:12px;}

/* Responsive adjustments */
@media (max-width:880px){
  .player{grid-template-columns:1fr; padding:12px;}
  .left{flex-direction:column; align-items:center;}
  .cover{width:80%; max-width:250px;}
  .controls{gap:8px; flex-wrap:wrap;}
  .playlist{max-height:300px;}
}

@media (max-width:500px){
  header{flex-direction:column; align-items:flex-start;}
  header nav a{margin-left:0; margin-top:8px;}
  .cover{width:100%; max-width:200px;}
  .title{font-size:16px;}
  .artist{font-size:12px;}
  .controls button{padding:8px 10px; font-size:14px;}
  .time{font-size:11px;}
  .pagination button{padding:3px 6px; font-size:10px;}
}

/* Playlist scrollbar */
.playlist::-webkit-scrollbar{
  width:8px;
}

.playlist::-webkit-scrollbar-track{
  background:transparent;
}

.playlist::-webkit-scrollbar-thumb{
  background:linear-gradient(180deg,var(--accent), #2b6ce4);
  border-radius:10px;
}

.playlist::-webkit-scrollbar-thumb:hover{
  background:var(--accent);
}

/* Firefox */
.playlist{
  scrollbar-width:thin;
  scrollbar-color: var(--accent) transparent;
}
/* ===== FIX CONTROLS COLOR IN LIGHT MODE ===== */
body.light button{
  color:#0f1724;
}

body.light button:hover{
  background:rgba(124,58,237,0.15);
}

body.light .controls i{
  color:#0f1724;
}

/* Progress bar background */
body.light .progress{
  background:rgba(0,0,0,0.1);
}

/* Playlist text */
body.light .track{
  color:#0f1724;
}

body.light .track:hover{
  background:rgba(0,0,0,0.05);
}

/* Pagination buttons */
body.light .pagination button{
  color:#0f1724;
}

/* Header text */
body.light header nav a{
  color:#0f1724;
}
body.light .controls button{
  border:1px solid rgba(0,0,0,0.08);
}

#likeBtn.active i{
  color:#ff4d6d;
}

.progress .bar{
  transition: width 0.2s linear;
}
.track.playing::after{
  content:"üéµ";
  margin-left:auto;
}

/* ===== VIDEO MODAL ===== */
.video-modal{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,0.6);
  display:none;
  align-items:center;
  justify-content:center;
  z-index:1000;
}

.video-modal.show{
  display:flex;
}

#videoCanvas{
  width:400px;
  max-width:90vw;
  border-radius:12px;
}

#greenVideo{
  position: absolute;
  left: -9999px;
  top: -9999px;
}


#closeVideo{
  position:absolute;
  top:20px;
  right:20px;
  background:var(--card);
  border:none;
  color:inherit;
  font-size:18px;
  padding:8px 12px;
  border-radius:50%;
  cursor:pointer;
}

/* ===== MOBILE FLOATING ICON FIX ===== */
@media (max-width:600px){

  .theme-toggle{
    width:44px;
    height:44px;
    bottom:16px;
    right:16px;
  }

  /* Video toggle sits ABOVE theme toggle */
  #videoToggle{
    right:16px !important;
    bottom:72px;
  }

  .theme-toggle i{
    font-size:18px;
  }
}

/* Extra small phones */
@media (max-width:380px){
  .theme-toggle{
    width:40px;
    height:40px;
  }

  #videoToggle{
    bottom:64px;
  }

  .theme-toggle i{
    font-size:16px;
  }
}

.video-modal{
  pointer-events:auto;
}

.theme-toggle{
  touch-action:manipulation;
}

#floatingUI {
  position: fixed;
  inset: 0;
  pointer-events: none; /* don‚Äôt block clicks */
  z-index: 1;
  overflow: hidden;
}

.floating-bubble {
  position: absolute;
  border-radius: 50%;
  opacity: 0.6;
  background: linear-gradient(135deg, #7c3aed, #2b6ce4);
  animation: floatAnim linear infinite;
}

@keyframes floatAnim {
  0% {
    transform: translateY(100vh) scale(0);
    opacity: 0;
  }
  10% {
    opacity: 0.3;
  }
  50% {
    opacity: 0.6;
  }
  100% {
    transform: translateY(-10vh) scale(1);
    opacity: 0;
  }
}

</style>
</head>

<div id="floatingUI"></div>
<script>
  const floatingUI = document.getElementById('floatingUI');

function createBubble() {
  const bubble = document.createElement('div');
  bubble.className = 'floating-bubble';
  const size = Math.random() * 20 + 10; // 10px‚Äì30px
  bubble.style.width = `${size}px`;
  bubble.style.height = `${size}px`;
  bubble.style.left = `${Math.random() * 100}vw`;
  bubble.style.animationDuration = `${Math.random() * 8 + 5}s`; // 5-13s
  floatingUI.appendChild(bubble);

  // Remove after animation ends
  setTimeout(() => bubble.remove(), parseFloat(bubble.style.animationDuration) * 1000);
}

// Continuously create bubbles
setInterval(createBubble, 500); // every 0.5s

</script>
<body>
  <div class="theme-toggle" id="themeToggle" title="Toggle theme">
  <i class="fas fa-moon" id="themeIcon"></i>
</div>


<header>
  <h1></h1>
  <nav>
 
  </nav>
</header>

<div class="container">
<div class="player">
  <div class="left">
    <div class="cover" id="cover"></div>
    <div class="title" id="title">Loading...</div>
    <div class="artist" id="artist"></div>
    <div class="progress" id="progress"><div class="bar" id="bar"></div></div>
    <div class="time"><span id="current">0:00</span><span id="duration">0:00</span></div>
    <div class="controls">

      <button id="prev"><i class="fas fa-backward"></i></button>
      <button id="play"><i class="fas fa-play"></i></button>
      <button id="next"><i class="fas fa-forward"></i></button>
      <button id="shuffle"><i class="fas fa-random"></i></button>
      <button id="repeat"><i class="fas fa-repeat"></i></button>
      
      <input type="range" id="volume" min="0" max="1" step="0.01" value="1" title="Volume">
    </div>
  </div>
  <div class="right">
    <input
  type="text"
  id="search"
  placeholder="Search song or artist..."
  style="
    padding:10px;
    border-radius:10px;
    border:none;
    margin-bottom:10px;
    background:var(--glass);
    color:inherit;
    outline:none;
  "
/>

    <b>Playlist</b>
    <div class="playlist" id="playlist"></div>
    <div class="pagination" id="pagination"></div>
  </div>
</div>
</div>
<footer>FavMusic Player ‚Ä¢ Made with Bitch</footer>

<audio id="audio"></audio>

<script>
// Playlist and Player logic
const audio = document.getElementById('audio');
const titleEl = document.getElementById('title');
const artistEl = document.getElementById('artist');
const playBtn = document.getElementById('play');
const nextBtn = document.getElementById('next');
const prevBtn = document.getElementById('prev');
const bar = document.getElementById('bar');
const progress = document.getElementById('progress');
const currentTimeEl = document.getElementById('current');
const durationEl = document.getElementById('duration');
const playlistEl = document.getElementById('playlist');
const coverEl = document.getElementById('cover');
const shuffleBtn = document.getElementById('shuffle');
const repeatBtn = document.getElementById('repeat');
const volumeSlider = document.getElementById('volume');
const paginationEl = document.getElementById('pagination');
const searchInput = document.getElementById('search');


let playlist = [
  {title:"Tabun",artist:"Yoasobi",file:"music/Tabun.mp3",cover:"cover/tabun.jpeg"},
  {title:"Orange",artist:"7!!",file:"music/Orange.mp3",cover:"cover/orange.jpeg"},
  {title:"Ren Swan",artist:"ÈÄ≤ÊíÉ„ÅÆÂ∑®‰∫∫",file:"music/Redswan.mp3",cover:"cover/redswan.jpeg"},
  {title:"Kamado Tanjiro no Uta",artist:"Risa Oribe",file:"music/Kamado.mp3",cover:"cover/kamado.jpeg"},
  {title:"Memories",artist:"Maki Otsuki",file:"music/Memories.mp3",cover:"cover/memories.jpeg"},
  {title:"Sparkle", artist:"Your Name",file: "music/Sparkle.mp3",cover:"cover/sparkle.jpeg"},
  {title:"Racing Into The Night", artist:"Yoasobi",file: "music/racing_into_the_night.mp3",cover:"cover/racing.png"},
  {title:"Akuma no Ko", artist:"Ai Higuchi",file: "music/Akumanoko.mp3",cover:"cover/akuma.jpg"},
  {title:"Night Dancer", artist:"Imase",file: "music/Nightdancer.mp3",cover:"cover/nightdancer.jpg"},
  {title:"Kamado Nezuko no Uta", artist:"Nami Nakagawa",file: "music/Kamadonezuko.mp3",cover:"cover/kamadonezuko.png"},

];
let current=0, isShuffle=false, isRepeat=false;
let currentPage=1, songsPerPage=9;

function formatTime(s){ if(!isFinite(s)) return '0:00'; s=Math.floor(s); const m=Math.floor(s/60); const sec=s%60; return m+':' + (sec<10?'0':'')+sec; }

function renderPlaylist(){
  playlistEl.innerHTML='';

  const keyword = searchInput.value.toLowerCase();

  const filteredPlaylist = playlist.filter(song =>
    song.title.toLowerCase().includes(keyword) ||
    song.artist.toLowerCase().includes(keyword)
  );

  let start = (currentPage - 1) * songsPerPage;
  let end = Math.min(start + songsPerPage, filteredPlaylist.length);

  for(let i = start; i < end; i++){
    const song = filteredPlaylist[i];

    const realIndex = playlist.indexOf(song);

    const div = document.createElement('div');
    div.className = 'track' + (realIndex === current ? ' playing' : '');

    div.innerHTML = `
      <span style="width:20px">${realIndex + 1}</span>
      <img src="${song.cover}">
      <span>${song.title} - ${song.artist}</span>
    `;

    div.onclick = () => loadSong(realIndex);
    playlistEl.appendChild(div);
  }

  renderPagination(filteredPlaylist.length);
}

searchInput.oninput = () => {
  currentPage = 1;
  renderPlaylist();
};
document.addEventListener('keydown', e => {
  if(e.key === 'Escape'){
    searchInput.value = '';
    renderPlaylist();
  }
});


function renderPagination(totalItems = playlist.length){
  paginationEl.innerHTML='';
  const totalPages = Math.ceil(totalItems / songsPerPage);

  for(let i = 1; i <= totalPages; i++){
    const btn = document.createElement('button');
    btn.textContent = i;
    btn.style.background =
      i === currentPage ? 'rgba(124,58,237,0.25)' : 'var(--glass)';

    btn.onclick = () => {
      currentPage = i;
      renderPlaylist();
    };

    paginationEl.appendChild(btn);
  }
}


function loadSong(i){
  current=i;
  const song=playlist[i];
  audio.src=song.file;
  titleEl.textContent=song.title;
  artistEl.textContent=song.artist || 'Unknown';
  coverEl.style.backgroundImage=`url('${song.cover}')`;
  audio.play();
  renderPlaylist();
}

playBtn.onclick=()=>audio.paused?audio.play():audio.pause();
nextBtn.onclick=()=>{if(isShuffle) loadSong(Math.floor(Math.random()*playlist.length)); else loadSong((current+1)%playlist.length);}
prevBtn.onclick=()=>loadSong((current-1+playlist.length)%playlist.length);
shuffleBtn.onclick=()=>{isShuffle=!isShuffle; shuffleBtn.style.backgroundColor=isShuffle?'rgba(124,58,237,0.25)':'var(--glass)';}
repeatBtn.onclick=()=>{isRepeat=!isRepeat; repeatBtn.style.backgroundColor=isRepeat?'rgba(124,58,237,0.25)':'var(--glass)';}
volumeSlider.oninput=()=>audio.volume=volumeSlider.value;

audio.ontimeupdate=()=>{bar.style.width=(audio.currentTime/audio.duration)*100+'%'; currentTimeEl.textContent=formatTime(audio.currentTime); durationEl.textContent=formatTime(audio.duration);}
progress.onclick=(e)=>{audio.currentTime=(e.offsetX/progress.clientWidth)*audio.duration;}
audio.onended=()=>{if(isRepeat) loadSong(current); else nextBtn.onclick();}

// initialize
renderPlaylist();
loadSong(0);


const themeToggle = document.getElementById('themeToggle');
const themeIcon = document.getElementById('themeIcon');

function updateThemeIcon(){
  if(document.body.classList.contains('light')){
    themeIcon.className = 'fas fa-sun';
  }else{
    themeIcon.className = 'fas fa-moon';
  }
}

themeToggle.onclick = () => {
  document.body.classList.toggle('light');
  updateThemeIcon();
};

// init icon
updateThemeIcon();


// ===== SAVE THEME =====
if(localStorage.getItem('theme') === 'light'){
  document.body.classList.add('light');
}

updateThemeIcon();

themeToggle.onclick = () => {
  document.body.classList.toggle('light');
  localStorage.setItem(
    'theme',
    document.body.classList.contains('light') ? 'light' : 'dark'
  );
  updateThemeIcon();
};

const likeBtn = document.getElementById('likeBtn');
let favorites = JSON.parse(localStorage.getItem('favorites') || '[]');

function updateLike(){
  likeBtn.classList.toggle('active', favorites.includes(current));
}

likeBtn.onclick = () => {
  if(favorites.includes(current)){
    favorites = favorites.filter(i => i !== current);
  }else{
    favorites.push(current);
  }
  localStorage.setItem('favorites', JSON.stringify(favorites));
  updateLike();
};

updateLike();


document.addEventListener('keydown', e => {
  if(e.target.tagName === 'INPUT') return;

  if(e.code === 'Space'){
    e.preventDefault();
    playBtn.onclick();
  }
  if(e.code === 'ArrowRight'){
    audio.currentTime += 5;
  }
  if(e.code === 'ArrowLeft'){
    audio.currentTime -= 5;
  }
  if(e.code === 'ArrowUp'){
    audio.volume = Math.min(1, audio.volume + 0.05);
  }
  if(e.code === 'ArrowDown'){
    audio.volume = Math.max(0, audio.volume - 0.05);
  }
});

const videoToggle = document.getElementById('videoToggle');
const videoModal = document.getElementById('videoModal');
const greenVideo = document.getElementById('greenVideo');
const canvas = document.getElementById('videoCanvas');
const ctx = canvas.getContext('2d');
const closeVideo = document.getElementById('closeVideo');

videoToggle.onclick = () => {
  videoModal.classList.add('show');
  greenVideo.currentTime = 0;

  // wait until the video is ready
  greenVideo.muted = true;
  greenVideo.play().catch(err => console.log('Video play failed:', err));

  greenVideo.addEventListener('canplay', function startDrawing() {
    drawVideo();
    greenVideo.removeEventListener('canplay', startDrawing);
  });
};



closeVideo.onclick = () => {
  videoModal.classList.remove('show');
  greenVideo.pause();
};

greenVideo.onloadedmetadata = () => {
  canvas.width = greenVideo.videoWidth;
  canvas.height = greenVideo.videoHeight;
};


function drawVideo(){
  if(!videoModal.classList.contains('show')) return;

  if(greenVideo.readyState >= 2){
    canvas.width = greenVideo.videoWidth;
    canvas.height = greenVideo.videoHeight;

    ctx.drawImage(greenVideo, 0, 0, canvas.width, canvas.height);

    const frame = ctx.getImageData(0, 0, canvas.width, canvas.height);
    const data = frame.data;

    for(let i=0;i<data.length;i+=4){
      const r=data[i], g=data[i+1], b=data[i+2];
      if(g>120 && g>r+30 && g>b+30) data[i+3]=0;
    }

    ctx.putImageData(frame,0,0);
  }

  requestAnimationFrame(drawVideo);
  // console.log('Drawing frame...'); // uncomment for debugging
}


const bgToggle = document.getElementById('bgToggle');
const bgColorPicker = document.getElementById('bgColorPicker');

// Show color picker when palette icon is clicked
bgToggle.onclick = () => bgColorPicker.click();

// When user picks a color
bgColorPicker.oninput = (e) => {
  document.body.style.background = e.target.value;
  localStorage.setItem('bgColor', e.target.value);
};

// Load saved background on page load
const savedBg = localStorage.getItem('bgColor');
if(savedBg){
  document.body.style.background = savedBg;
}





</script>

</body>
</html>
